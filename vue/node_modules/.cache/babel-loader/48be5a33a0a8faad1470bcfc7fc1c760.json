{"remainingRequest":"/home/Nico/Github/MagicLink/vue/node_modules/thread-loader/dist/cjs.js!/home/Nico/Github/MagicLink/vue/node_modules/babel-loader/lib/index.js!/home/Nico/Github/MagicLink/vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/Nico/Github/MagicLink/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/Nico/Github/MagicLink/vue/src/views/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/Nico/Github/MagicLink/vue/src/views/login.vue","mtime":1589507531235},{"path":"/home/Nico/Github/MagicLink/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/Nico/Github/MagicLink/vue/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/Nico/Github/MagicLink/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/Nico/Github/MagicLink/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/Nico/Github/MagicLink/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGxvZ2luX2VudGVyIGZyb20gIkAvY29tcG9uZW50cy9sb2dpbl9lbnRlci52dWUiOwppbXBvcnQgbG9naW5fd2FpdGluZyBmcm9tICJAL2NvbXBvbmVudHMvbG9naW5fd2FpdGluZy52dWUiOwppbXBvcnQgeyBncnBjIH0gZnJvbSAiQGltcHJvYmFibGUtZW5nL2dycGMtd2ViIjsKaW1wb3J0IHsgTG9naW4gfSBmcm9tICIuLi9sb2dpbmdSUEMvbG9naW5fcGJfc2VydmljZSI7IC8vc2VydmljZQoKaW1wb3J0IHsgbG9naW5JbmZvLCBqd3QgfSBmcm9tICIuLi9sb2dpbmdSUEMvbG9naW5fcGIiOyAvL3R5cGUKCmltcG9ydCByb3V0ZXIgZnJvbSAiLi4vcm91dGVyIjsKaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwp2YXIgU3RhdGUgPSB7CiAgSWRsZTogMSwKICBXYWl0aW5nOiAyCn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAibG9naW4iLAogIGNvbXBvbmVudHM6IHsKICAgIGxvZ2luX2VudGVyOiBsb2dpbl9lbnRlciwKICAgIGxvZ2luX3dhaXRpbmc6IGxvZ2luX3dhaXRpbmcKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmlzTG9nZ2VkSW4oKTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50U3RhdGU6IFN0YXRlLklkbGUsCiAgICAgIFN0YXRlOiBTdGF0ZSwKICAgICAgcmVzcG9uY2U6ICIiLAogICAgICBlbWFpbDogIiIKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2dpbjogZnVuY3Rpb24gbG9naW4ocGFzc2VkRW1haWwpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuZW1haWwgPSBwYXNzZWRFbWFpbDsKICAgICAgdmFyIHNlbmRpbmdFbWFpbCA9IG5ldyBsb2dpbkluZm8oKTsKICAgICAgc2VuZGluZ0VtYWlsLnNldEVtYWlsKHBhc3NlZEVtYWlsKTsKICAgICAgc2VuZGluZ0VtYWlsLnNldEtleSgxKTsKICAgICAgdGhpcy5jdXJyZW50U3RhdGUgPSBTdGF0ZS5XYWl0aW5nOwogICAgICBncnBjLnVuYXJ5KExvZ2luLmxvZ2luLCB7CiAgICAgICAgcmVxdWVzdDogc2VuZGluZ0VtYWlsLAogICAgICAgIGhvc3Q6IHRoaXMuJGhvc3RuYW1lLAogICAgICAgIG9uRW5kOiBmdW5jdGlvbiBvbkVuZChyZXMpIHsKICAgICAgICAgIHZhciBzdGF0dXMgPSByZXMuc3RhdHVzLAogICAgICAgICAgICAgIHN0YXR1c01lc3NhZ2UgPSByZXMuc3RhdHVzTWVzc2FnZSwKICAgICAgICAgICAgICBoZWFkZXJzID0gcmVzLmhlYWRlcnMsCiAgICAgICAgICAgICAgbWVzc2FnZSA9IHJlcy5tZXNzYWdlLAogICAgICAgICAgICAgIHRyYWlsZXJzID0gcmVzLnRyYWlsZXJzOwoKICAgICAgICAgIGlmIChzdGF0dXMgPT09IGdycGMuQ29kZS5PSyAmJiBtZXNzYWdlKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJqd3QiLCBtZXNzYWdlLnRvT2JqZWN0KCkuand0KTsKICAgICAgICAgICAgVnVlLnByb3RvdHlwZS4kdXNlciA9IF90aGlzLmVtYWlsOwogICAgICAgICAgICByb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coInN0YXR1czoiLCBzdGF0dXMsIHN0YXR1c01lc3NhZ2UsIGhlYWRlcnMsIG1lc3NhZ2UsIHRyYWlsZXJzKTsKICAgICAgICAgICAgX3RoaXMucmVzcG9uY2UgPSAiWW91J3JlIGxpbmsgaXMgZXhwaXJlZCB0cnkgYWdhaW4iOwogICAgICAgICAgICBfdGhpcy5jdXJyZW50U3RhdGUgPSBTdGF0ZS5JZGxlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaXNMb2dnZWRJbjogZnVuY3Rpb24gaXNMb2dnZWRJbigpIHsKICAgICAgdmFyIGxvY2FsSldUID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImp3dCIpOwogICAgICB2YXIgcmVxID0gbmV3IGp3dCgpOwogICAgICByZXEuc2V0Snd0KGxvY2FsSldUKTsKICAgICAgZ3JwYy51bmFyeShMb2dpbi5pc0xvZ2dlZEluLCB7CiAgICAgICAgcmVxdWVzdDogcmVxLAogICAgICAgIGhvc3Q6IHRoaXMuJGhvc3RuYW1lLAogICAgICAgIG9uRW5kOiBmdW5jdGlvbiBvbkVuZChyZXMpIHsKICAgICAgICAgIHZhciBzdGF0dXMgPSByZXMuc3RhdHVzLAogICAgICAgICAgICAgIHN0YXR1c01lc3NhZ2UgPSByZXMuc3RhdHVzTWVzc2FnZSwKICAgICAgICAgICAgICBoZWFkZXJzID0gcmVzLmhlYWRlcnMsCiAgICAgICAgICAgICAgbWVzc2FnZSA9IHJlcy5tZXNzYWdlLAogICAgICAgICAgICAgIHRyYWlsZXJzID0gcmVzLnRyYWlsZXJzOwoKICAgICAgICAgIGlmIChzdGF0dXMgPT09IGdycGMuQ29kZS5PSyAmJiBtZXNzYWdlKSB7CiAgICAgICAgICAgIHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBwYXRoOiAnLycKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygic3RhdHVzOiIsIHN0YXR1cywgc3RhdHVzTWVzc2FnZSwgaGVhZGVycywgbWVzc2FnZSwgdHJhaWxlcnMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"container\">\n        <div class=\"containerInner\">\n        <login_enter v-on:email=\"login\" v-if=\"currentState == State.Idle\"/>\n        <login_waiting v-bind:email=email v-if=\"currentState == State.Waiting\"/>\n        <p v-if=\"currentState == State.Idle\">{{responce}}</p>\n        </div>\n    </div>\n</template>\n\n<script>\nimport login_enter from \"@/components/login_enter.vue\"\nimport login_waiting from \"@/components/login_waiting.vue\"\nimport { grpc } from \"@improbable-eng/grpc-web\";\nimport { Login } from \"../logingRPC/login_pb_service\"; //service\nimport { loginInfo, jwt} from \"../logingRPC/login_pb\"; //type\nimport router from \"../router\"\nimport Vue from \"vue\"\nconst State = {\n    Idle: 1,\n    Waiting: 2,\n}\nexport default {\n    name: \"login\",\n    components: {\n        login_enter,\n        login_waiting,\n    },\n    created() {\n        this.isLoggedIn();\n    },\n    data() {\n        return {\n            currentState: State.Idle,\n            State,\n            responce:\"\",\n            email:\"\",\n        }\n    },\n    methods: {\n        login(passedEmail) {\n            this.email = passedEmail\n            const sendingEmail = new loginInfo();\n            sendingEmail.setEmail(passedEmail);\n            sendingEmail.setKey(1);\n\n            this.currentState = State.Waiting;\n            grpc.unary(Login.login, {\n                request: sendingEmail,\n                host: this.$hostname,\n                onEnd: res => {\n                    const { status, statusMessage, headers, message, trailers } = res;\n                    if (status === grpc.Code.OK && message) {\n                        localStorage.setItem(\"jwt\", message.toObject().jwt);\n                        Vue.prototype.$user = this.email\n                        router.push({path: '/'})\n                    } else {\n                    console.log(\"status:\", status, statusMessage, headers, message, trailers)\n                        this.responce = \"You're link is expired try again\"\n                        this.currentState = State.Idle;\n                    }\n                }\n            })\n        },\n        isLoggedIn: function() {\n            let localJWT = localStorage.getItem(\"jwt\")\n\n            const req = new jwt()\n            req.setJwt(localJWT)\n            grpc.unary(Login.isLoggedIn, {\n                request: req,\n                host: this.$hostname,\n                onEnd: res => {\n                    const { status, statusMessage, headers, message, trailers } = res;\n                    if (status === grpc.Code.OK && message) {\n                        router.push({path: '/'})\n                    } else {\n                       console.log(\"status:\", status, statusMessage, headers, message, trailers)\n                    }\n                }\n            })\n        }\n    },\n}\n</script>\n\n\n"],"sourceRoot":"src/views"}]}